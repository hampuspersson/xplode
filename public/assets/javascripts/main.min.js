"use strict";!function(){}(jQuery);var xplodeApp=angular.module("xplodeApp",["localStorage"]);xplodeApp.config(function($routeProvider){$routeProvider.when("/",{controller:"DashboardController",templateUrl:"partials/dashboard.html"}).when("/program/:programId",{controller:"ProgramController",templateUrl:"partials/program.html"}).when("/drill/:drillId",{controller:"DrillController",templateUrl:"partials/drill.html"}).when("/drill/:drillId/add",{controller:"DrillController",templateUrl:"partials/add-drill.html"})}),xplodeApp.factory("$api",function($http){function apiPrefix(dir,params){var prefix="api/";return dir=dir||"",params=params?"/"+params:"",prefix+dir+params}return{getAllUsers:function(){return $http.get(apiPrefix("users")).then(function(result){return result.data})},getCurrentUser:function(id){return $http.get(apiPrefix("users",id)).then(function(result){return result.data})},getLoggedInUser:function(){return $http.get(apiPrefix("users","?getLoggedInUser")).then(function(result){return result.data})},getAllPrograms:function(){return $http.get(apiPrefix("programs")).then(function(result){return result.data})},getProgram:function(programId){return $http.get(apiPrefix("programs",programId)).then(function(result){return result.data})},getUserPrograms:function(userId){return $http.get(apiPrefix("programs","?user="+userId)).then(function(result){return result.data})},getAllDrills:function(){return $http.get(apiPrefix("drills")).then(function(result){return result.data})},getDrill:function(drillId){return $http.get(apiPrefix("drills",drillId)).then(function(result){return result.data})},getDrillsInProgram:function(programId){return $http.get(apiPrefix("drills","?program="+programId)).then(function(result){return result.data})},getResults:function(drillId){return $http.get(apiPrefix("results","?drill="+drillId)).then(function(result){return result.data})},addResult:function(data){return $http.post(apiPrefix("results"),data).then(function(result){return result.data})}}}),xplodeApp.factory("$utilities",function(){function addZero(n){return 10>n?"0"+n:""+n}return{getTime:function(timestamp){timestamp=timestamp||(new Date).getTime();var date=new Date(timestamp),obj={year:date.getFullYear(),month:addZero(date.getMonth()+1),day:addZero(date.getDate()),hours:addZero(date.getHours()),minutes:addZero(date.getMinutes()),seconds:addZero(date.getSeconds())};return obj.year+"-"+obj.month+"-"+obj.day+" "+obj.hours+":"+obj.minutes+":"+obj.seconds}}}),xplodeApp.controller("DashboardController",function($scope,$api,$store){function init(){$api.getLoggedInUser().then(function(result){$scope.currentUserId=result,$scope.user=$api.getCurrentUser($scope.currentUserId).then(function(result){return result.max=jQuery.parseJSON(result.max),result.firstName=result.name.substring(0,result.name.indexOf(" ")),$store.set("user",result),result}),$scope.programs=$api.getUserPrograms($scope.currentUserId).then(function(result){return result.programs}),$scope.drills=$api.getAllDrills().then(function(result){return result})})}init()}),xplodeApp.controller("ProgramController",function($scope,$routeParams,$api,$store){function init(){$store.get("user")?$scope.user=$store.get("user"):$scope.currentUserId=$api.getLoggedInUser().then(function(){$scope.user=$api.getCurrentUser($scope.currentUserId).then(function(result){return result.max=jQuery.parseJSON(result.max),result.firstName=result.name.substring(0,result.name.indexOf(" ")),$store.set("user",result),result})}),$scope.program=$api.getProgram($routeParams.programId).then(function(result){return $store.set("program",result),result}),$scope.programDrills=$api.getDrillsInProgram($routeParams.programId).then(function(result){return result})}init()}),xplodeApp.controller("DrillController",function($scope,$routeParams,$api,$store,$utilities){function init(){$scope.user=$store.get("user"),$scope.program=$store.get("program"),$scope.drillReps=10,$scope.drillWeight=80,$scope.drillId=$routeParams.drillId,$scope.drill=$api.getDrill($routeParams.drillId).then(function(result){return result}),$scope.reps=$api.getResults($scope.drillId).then(function(result){return result})}init(),$scope.addSet=function(){$scope.reps.$$v.unshift({created_at:$utilities.getTime(),user_id:$scope.user.id,drill_id:$scope.drillId,reps:$scope.drillReps,weight:$scope.drillWeight}),$api.addResult({user_id:$scope.user.id,drill_id:$scope.drillId,program_id:$scope.program.id,reps:$scope.drillReps,weight:$scope.drillWeight}).then(function(){})}});
/*
//@ sourceMappingURL=map/source-map-main.js
*/